# atl_gim_bot

atl_gim_bot - бот, который работает Telegram https://t.me/atl_gim_bot

На специализации атлетической гимнастики существует анонимная Google-таблица, в которой преподаватель проставляет посещений для студентов МФТИ  https://docs.google.com/spreadsheets/d/1gGOlwlh6J4sbkC9ZwWkyVEjl0ukcOOCN8CZBtlFWxn4/edit?usp=sharing

Для того чтобы узнать количество своих посещений занятий, пользователь должен сопоставить номер своего электронного студенческого билета. 

Данный бот позволяет cтуденту один раз ввести номер своего электронного студенческого билета и быстро получать информации о своих посещениях  занятий физкультуры в любимом мессенджере.

## Установка и запуск бота
Перед запуском проекта нужно установить следующие библлиотеки:

- asyncio: pip install asyncio
- gspread: pip install gspread
- aiogram: pip install aiogram

В файле main необходимо указать данные сервисного аккаунта Google и token для бота.

После этого выполните python3 main.py

## Особености реализации

Проект состоит из main.py м двух модулей: sheet.py - модуль, в котором описан класс, который позволяет получать информацию из Google-таблицы пользователя, и data_base.py - модуль, в котором описан класс, который позволяет работаь с JSON базой данных пользователей. 

Drive API - позволяет получать данные из Google-таблицы, но работает не очень быстро, поэтому для каждого пользователя в базе данных бота хранится информация обо всех посещениях занятий, при этом она обновляется с частотой (количество пользователей) * 5 с (Drive API не позволяет делать много запросов за минуту, возвращает ошибку)

В базе данных пользователей хранится telegramID пользователя, номер его электронного студенческого, данные о посещаемости и дата и время о последнем обновлении.

## Как пользоваться ботом. 

https://t.me/atl_gim_bot

Для регистрации необходимо в меню бота выбрать команду /registrate, ввести номер своего студенческого. 

Для получения информации о посещениях необходимо в меню бота выбрать команду /visits.

## Особенности работы бота.

Бот запущен на pythonanywhere.com на бесплатном аккаунте, со всевозможными ограничениями и всё равно работает не очень быстро)))


